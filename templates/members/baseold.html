<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}VCF Member{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Space Grotesk', 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #0f2027 0%, #2c5364 100%);
      background-size: 200% 200%;
      animation: bgMove 18s ease-in-out infinite;
      color: #f5f5f5;
      overflow-x: hidden;
    }
    @keyframes bgMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .glass {
      background: rgba(30, 41, 59, 0.7);
      border: 1.5px solid rgba(109, 213, 237, 0.18);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37), 0 0 24px #2193b0a0;
      backdrop-filter: blur(18px);
      border-radius: 1.5rem;
      transition: transform 0.35s cubic-bezier(.4,2,.3,1), box-shadow 0.35s;
      position: relative;
      overflow: hidden;
    }
    .glass.hoverable:hover {
        transform: translateY(-8px) scale(1.03);
        box-shadow: 0 16px 40px 0 #2193b0cc, 0 0 32px #e11d74cc;
        border-color: #6dd5ed;
        }
    .neon {
      color: #6dd5ed;
      text-shadow: 0 0 8px #6dd5ed, 0 0 2px #e11d74;
    }
    .neon-accent {
      color: #e11d74;
      text-shadow: 0 0 8px #e11d74, 0 0 2px #6dd5ed;
    }
    .glass-btn {
      background: linear-gradient(90deg, #6dd5ed 0%, #e11d74 100%);
      color: #fff;
      font-weight: 600;
      border-radius: 12px;
      padding: 0.5rem 1.25rem;
      box-shadow: 0 0 10px #2193b0a0;
      transition: all 0.3s cubic-bezier(.4,2,.3,1);
      border: none;
      outline: none;
    }
    .glass-btn:hover {
      transform: scale(1.07);
      box-shadow: 0 0 24px #6dd5edcc, 0 0 8px #e11d74cc;
      background: linear-gradient(90deg, #e11d74 0%, #6dd5ed 100%);
    }
    .scrollbar::-webkit-scrollbar { width: 8px; background: #1e293b; }
    .scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    .sortable th { cursor: pointer; }
    .sortable th:hover { color: #6dd5ed; }
    
    /* Updated Tape Message Styles */
    .message-tape {
      position: fixed;
      top: 4rem;
      left: 50%;
      transform: translateX(-50%) translateY(-100%);
      height: 2.5rem;
      width: 25%;
      min-width: 300px;
      background: linear-gradient(90deg, #ff9800 0%, #ffc107 100%);
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      z-index: 999;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      transition: transform 0.3s ease-out;
      border-radius: 0 0 0.5rem 0.5rem;
    }
    
    .message-tape.visible {
      transform: translateX(-50%) translateY(0);
    }
    
    .message-tape-content {
      display: flex;
      white-space: nowrap;
      animation: scrollTape 20s linear infinite;
      width: 100%;
      text-align: center;
      padding: 0 2rem;
    }
    
    @keyframes scrollTape {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    
    .message-tape-close {
      position: absolute;
      right: 1rem;
      cursor: pointer;
      font-weight: bold;
      color: #000;
    }
    
    .message-tape-trigger {
      font-style: italic;
      color: #333;
      margin-right: 0.5rem;
      font-weight: 600;
    }
    
    @media (max-width: 768px) {
      .message-tape {
        width: 90%;
        min-width: auto;
        top: 4rem;
        height: auto;
        min-height: 2.5rem;
        padding: 0.5rem 2.5rem 0.5rem 1rem;
      }
      
      .message-tape-content {
        white-space: normal;
        animation: none;
        padding: 0;
      }
    }
  </style>
  {% block extra_head %}{% endblock %}
</head>
<body class="min-h-screen flex flex-col md:flex-row bg-slate-900">

  <!-- Sidebar -->
  <aside id="sidebar" class="glass fixed inset-y-0 left-0 z-30 w-64 max-w-full h-screen transform transition-transform duration-300 -translate-x-full md:fixed md:top-0 md:left-0 md:h-screen md:z-40 md:translate-x-0 md:static md:transform-none md:flex md:flex-col shadow-xl">
    <div class="flex items-center h-16 px-6 border-b border-blue-800">
      <span class="text-2xl font-bold tracking-wide neon">VCF Member</span>
    </div>
    <nav class="flex-1 py-6 px-2 space-y-2 scrollbar overflow-y-auto md:overflow-y-visible">
      <a href="{% url 'members:dashboard' %}" class="flex items-center px-4 py-3 rounded-lg hover:bg-blue-800 transition group sidebar-link">
        <svg class="w-6 h-6 mr-3 neon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6"/></svg>
        Dashboard
      </a>
      <a href="{% url 'members:vcf_tabs' %}" class="flex items-center px-4 py-3 rounded-lg hover:bg-blue-800 transition group sidebar-link">
        <svg class="w-6 h-6 mr-3 neon-accent" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 17v-2a4 4 0 014-4h4a4 4 0 014 4v2M9 17H7a2 2 0 01-2-2v-2a2 2 0 012-2h2m0 0V7a4 4 0 014-4h0a4 4 0 014 4v2m-8 4h8"/></svg>
        VCFs
      </a>
      <a href="{% url 'members:member_settings' %}" class="flex items-center px-4 py-3 rounded-lg hover:bg-blue-800 transition group sidebar-link">
        <svg class="w-6 h-6 mr-3 neon-accent" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 8v4l3 3m6 0a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        Settings
      </a>
      <a href="{% url 'members:logout' %}" class="flex items-center px-4 py-3 rounded-lg hover:bg-red-600 transition group mt-8 sidebar-link">
        <svg class="w-6 h-6 mr-3 text-red-300 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h4a2 2 0 012 2v1"/></svg>
        Logout
      </a>
    </nav>
    <div class="px-6 py-4 border-t border-blue-800 text-xs text-blue-200">
      &copy; {{ now|date:'Y' }} VCF Member &mdash; v1.0.0
    </div>
  </aside>

  <!-- Overlay for mobile sidebar -->
  <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-40 z-20 hidden md:hidden"></div>

  <!-- Sticky Header -->
  <header class="fixed top-0 z-50 glass flex flex-row flex-wrap items-center px-4 sm:px-6 h-16 backdrop-blur-lg transition-all duration-300 left-0 right-0 md:left-[256px]">
    <div class="flex items-center flex-shrink-0">
      <button id="menu-btn" class="md:hidden mr-4 focus:outline-none">
        <svg class="w-7 h-7 neon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
      <span class="text-xl font-semibold neon tracking-wide">VCF Member Dashboard</span>
    </div>
    <div class="flex-1 flex justify-center">
      <form class="hidden md:flex items-center gap-2" action="#" method="get" autocomplete="off">
        <input type="text" placeholder="Search..." class="rounded-lg px-3 py-1.5 bg-slate-800 text-white border border-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm w-36 md:w-64" />
        <button type="submit" class="glass-btn px-3 py-1.5 flex items-center justify-center text-xs">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/></svg>
        </button>
      </form>
    </div>
    <div class="hidden md:flex items-center gap-3 flex-shrink-0">
      <span class="text-gray-200 font-medium">{% if request.user.profile and request.user.profile.email %}{{ request.user.profile.email }}{% else %}{{ request.user.email }}{% endif %}</span>
      <img src="https://img.icons8.com/ios-filled/50/1e293b/admin-settings-male.png" alt="Member" class="w-8 h-8 rounded-full border-2 border-blue-900 shadow glass-avatar" />
    </div>
  </header>

  <!-- Updated Message Tape -->
  {% if messages %}
  <div id="messageTape" class="message-tape">
    <div class="message-tape-content">
      {% for message in messages %}
        {% if 'auto-dismiss' in message.tags %}
          {% if message.extra_tags %}
            <span class="message-tape-trigger">{{ message.extra_tags }}:</span>
          {% endif %}
          <span class="font-medium">{{ message }}</span>
          {% if not forloop.last %}<span class="mx-2">•</span>{% endif %}
        {% endif %}
      {% endfor %}
    </div>
    <span class="message-tape-close" onclick="document.getElementById('messageTape').remove()">×</span>
  </div>
  {% endif %}

  <!-- Main content wrapper -->
  <main class="flex-1 flex flex-col min-h-screen transition-all duration-300 p-2 xs:p-4 sm:p-6 overflow-x-hidden md:ml-64 pt-20 w-full max-w-full">
    {% block content %}{% endblock %}
    
    <!-- Footer -->
    <footer class="glass shadow-inner py-4 px-6 text-center text-xs text-gray-400 mt-auto">
      &copy; {{ now|date:'Y' }} VCF Member &mdash; All rights reserved. Version 1.0.0
    </footer>
  </main>

  <!-- Scripts -->
  <script>
    // Sidebar toggle
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    const menuBtn = document.getElementById('menu-btn');
    menuBtn.addEventListener('click', () => {
      sidebar.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
    });
    overlay.addEventListener('click', () => {
      sidebar.classList.add('-translate-x-full');
      overlay.classList.add('hidden');
    });

    // Message tape functionality
    document.addEventListener('DOMContentLoaded', function() {
      const messageTape = document.getElementById('messageTape');
      if (messageTape) {
        // Show the tape
        setTimeout(() => {
          messageTape.classList.add('visible');
        }, 100);
        
        // Auto-dismiss after 5 seconds
        setTimeout(() => {
          messageTape.style.transition = 'transform 0.1s ease-out';
          messageTape.style.transform = 'translateX(-50%) translateY(-100%)';
          
          // Remove after animation completes
          setTimeout(() => {
            messageTape.remove();
          }, 500);
        }, 15000); // 15 seconds display time

        // Pause animation on hover
        messageTape.addEventListener('mouseenter', () => {
          const content = messageTape.querySelector('.message-tape-content');
          if (content) {
            content.style.animationPlayState = 'paused';
          }
        });
        
        // Resume animation when mouse leaves
        messageTape.addEventListener('mouseleave', () => {
          const content = messageTape.querySelector('.message-tape-content');
          if (content) {
            content.style.animationPlayState = 'running';
          }
        });
      }
    });
  </script>
  {% block extra_js %}{% endblock %}
</body>
</html>